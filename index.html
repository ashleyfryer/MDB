<!DOCTYPE html>

<!--
File Name: index.html
Project: The Movie Database API
Date: 5/22/18
Programmer: Ashley Fryer
-->

<html>

<head>

<!--Codes page as mobile first-->
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="UTF-8">
<meta name="author" content="Ashley Fryer">
    
<title>The Movie Database Project</title>
    
    <!--Fetch Movie Database API Info-->
    <script>
        var queryString = document.URL.substring( document.URL.indexOf('=') + 1 );
        var xhr = new XMLHttpRequest();
        xhr.open("GET", "https://api.themoviedb.org/3/search/movie?api_key=3daaa224d520ad43baab7a6b2c604dca&query=" + queryString, false);
        xhr.send();
        console.log(xhr.status); // if this returns 200, then you are in like Flynn
        var movieObject = JSON.parse(xhr.responseText);
        console.log(movieObject);
        
        var movieID = movieObject.results["0"].id;
        var xhr = new XMLHttpRequest();
        xhr.open("GET", "https://api.themoviedb.org/3/movie/" + movieID + "/recommendations?api_key=3daaa224d520ad43baab7a6b2c604dca&language=en-US&page=1", false);
        xhr.send();
        console.log(xhr.status); // if this returns 200, then you are in like Flynn
        var movieDiscover = JSON.parse(xhr.responseText);
        console.log(movieObject);
        
        var xhr = new XMLHttpRequest();
        xhr.open("GET", "https://api.themoviedb.org/3/movie/now_playing?api_key=3daaa224d520ad43baab7a6b2c604dca&language=en-US&page=1", false);
        xhr.send();
        console.log(xhr.status); // if this returns 200, then you are in like Flynn
        var moviePopular = JSON.parse(xhr.responseText);
        console.log(movieObject);
    </script>
    
    <!--JQuery Library-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    
</head>

<body class="section group">
    
<header>
    <h1>Movie Database API</h1>
</header>
    
<!--Now Playing-->   
<section>
    <h2>Now Playing</h2>
</section>

<!--Search form--> 
<form action="index.html" method="get">
 Search for a Movie:
 <input type="text" name="title">
 <button type="submit">Search for movie by title</button>
</form>
    
<main>
<h2>Title- N/A</h2>
Year:    
<p id="year"></p>
Image:   
<img id="poster" src= "">
Date:
<p id="date"></p>
Overview:
<p id="overview"></p>
Language: 
<p id="language"></p>
Popularity:  
<p id="popularity"></p>
Genre(s):  
<p id="genre"></p>
</main>
    
<footer>
    All information comes from the TMBD API.
</footer>
    
<copyright>
    This is the copyright
</copyright>
    
<script>
//jQuery block that actually adds the JSON data to the 
//webpage
    
$("h2").text(movieObject.results["0"].original_title);
    
$("#related").text(movieDiscover.results["0"].original_title);
    
$("#popular").text(moviePopular.results["0"].original_title);
    
$("#poster").attr("src", movieObject.results["0"].poster_path);
    
$("#date").text(movieObject.results["0"].release_date);
    
$("#overview").text(movieObject.results["0"].overview);
    
$("#language").text(movieObject.results["0"].original_language);

$("#popularity").text(movieObject.results["0"].vote_average);
    
$("#genre").text(movieObject.results["0"].genre_ids);
    
</script>
    
</body>

</html>